<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    padding: 20px;
    margin: 0;
  }

  .container {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  input {
    border: 1px solid #e5e5e5;
    border-radius: 4px;
    padding: 8px;
    width: 100%;
    box-sizing: border-box;
  }

  .button-group {
    display: flex;
    gap: 8px;
  }

  button {
    flex: 1;
    padding: 8px 16px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-weight: 500;
  }

  #hideButton {
    background-color: #f0f0f0;
    color: #333;
  }

  #showButton {
    background-color: #3F6ECC;
    color: white;
  }

  button:hover {
    opacity: 0.9;
  }

  .loading {
    opacity: 0.5;
    cursor: not-allowed !important;
  }

  .spinner {
    display: none;
    width: 18px;
    height: 18px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid #18a0fb;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 10px auto;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .processing .spinner {
    display: block;
  }

  .processing button,
  .processing input {
    pointer-events: none;
    opacity: 0.7;
  }
</style>

<div class="container">
  <input id="layerName" type="text" placeholder="レイヤー名を入力">
  <div class="button-group">
    <button id="hideButton">非表示にする</button>
    <button id="showButton">表示する</button>
  </div>
  <div class="spinner"></div>
</div>

<script>
// 処理中の状態を管理
let isProcessing = false;

function setProcessingState(processing) {
  isProcessing = processing;
  document.querySelector('.container').classList.toggle('processing', processing);
}

function handleLayerOperation(type) {
  if (isProcessing) return;

  const layerName = document.getElementById('layerName').value;
  if (!layerName.trim()) {
    return;
  }

  setProcessingState(true);

  parent.postMessage({ 
    pluginMessage: { 
      type: type,
      layerName: layerName
    }
  }, '*');
}

document.getElementById('hideButton').onclick = () => {
  handleLayerOperation('hide-layers');
}

document.getElementById('showButton').onclick = () => {
  handleLayerOperation('show-layers');
}

// Figmaからのメッセージを受け取る
window.onmessage = (event) => {
  const msg = event.data.pluginMessage;
  if (msg && msg.type === 'operation-complete') {
    setProcessingState(false);
  }
};
</script>